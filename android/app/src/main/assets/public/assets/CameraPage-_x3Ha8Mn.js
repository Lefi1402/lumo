import{d as C,r as s,O as b,P as I,y as P,c as x,a as n,u as t,e as R,b as l,h as B,m as M,n as T,g as V,p as o,A as E,f as N,k as O,Q as U,o as L,E as j,x as g}from"./index-Bs_OvxHx.js";import{l as D,s as H}from"./photoService-zMGk2de_.js";const W={class:"camera-controls"},A={class:"camera-slot"},G=["src"],K={class:"camera-slot"},z=C({__name:"CameraPage",setup(Q){const _=j(),c=s(null),d=s(null),r=s(null),i=s(null),u=s("environment");async function f(){m();try{r.value=await navigator.mediaDevices.getUserMedia({video:{facingMode:u.value}}),c.value&&(c.value.srcObject=r.value)}catch(e){console.error("Kameraâ€‘Start fehlgeschlagen:",e)}}function m(){var e;(e=r.value)==null||e.getTracks().forEach(a=>a.stop())}async function v(){const e=await D();i.value=e.length>0?e[0].webPath:null}async function p(){const e=c.value,a=d.value;if(!e||!a)return;a.width=e.videoWidth,a.height=e.videoHeight;const h=a.getContext("2d");if(!h)return;h.drawImage(e,0,0,a.width,a.height);const w=a.toDataURL("image/jpeg",.8).split(",")[1];await H(w),await v()}async function y(){u.value=u.value==="user"?"environment":"user",await f()}const k=()=>_.push("/tabs/gallery");return b(f),I(m),P(v),(e,a)=>(g(),x(t(R),null,{default:n(()=>[l(t(V),null,{default:n(()=>[l(t(B),null,{default:n(()=>[l(t(M),{class:"lumo-title-center"},{default:n(()=>a[0]||(a[0]=[T("LUMO",-1)])),_:1,__:[0]})]),_:1})]),_:1}),l(t(L),{fullscreen:!0,class:"camera-content"},{default:n(()=>[o("video",{ref_key:"videoRef",ref:c,autoplay:"",playsinline:"",class:"camera-preview"},null,512),o("canvas",{ref_key:"canvasRef",ref:d,style:{display:"none"}},null,512),o("div",W,[o("div",A,[i.value?(g(),E("img",{key:0,src:i.value,class:"camera-thumbnail",onClick:k},null,8,G)):N("",!0)]),o("div",{class:"camera-slot"},[o("button",{class:"camera-button",onClick:p})]),o("div",K,[l(t(O),{icon:t(U),class:"camera-toggle",onClick:y},null,8,["icon"])])])]),_:1})]),_:1}))}});export{z as default};
